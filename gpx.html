---
layout: default
title: GPX
permalink: /gpx/
---

<div class="gpx-header">
  <div class="gpx-title-block">
    <h1 class="gpxpage-title">GPX courses</h1>
    <p class="gpx-intro">Feel free to steal.</p>
    <button id="showMapBtn" class="show-map-button">Show map</button>
  </div>

  <div class="filters-tile">
    <h5>Filter courses</h5>
    <div class="filters">
      <label for="minDistance">Min Distance (km):</label>
      <input type="number" id="minDistance" placeholder="0" min="0" step="10">
      <label for="maxDistance">Max Distance (km):</label>
      <input type="number" id="maxDistance" placeholder="999" min="0" step="10">
      <label for="locationFilter">Location:</label>
      <select id="locationFilter">
        <option value="">All</option>
        <option value="Luebeck">LÃ¼beck</option>
        <option value="Hamburg">Hamburg</option>
        <option value="Stockelsdorf">Stockelsdorf</option>
        <option value="Schleswig">Schleswig</option>
      </select>

      <div class="filter-buttons">
        <button id="applyFilter">Filter</button>
        <button id="resetFilter">Reset</button>
      </div>
    </div>
  </div>
</div>

<div class="map-wrapper">
  <div id="visitedMapContainer" style="display:none; ">
    <h3>Visited streets</h3>
      <div id="visitedMap" style="height: 500px; border: 1px solid #ccc;"></div>
    </div>
</div>

<div id="gpxList" class="gpx"></div>


<script>
  const gpxJsonUrl = "{{ site.baseurl }}/assets/data/gpx_courses.json";
  const baseUrl = "{{ site.baseurl }}";
</script>
<script src="{{ site.baseurl }}/assets/js/my_js.js"></script>

<!-- Leaflet CSS -->
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
/>
<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<!-- Leaflet GPX plugin -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-gpx/1.7.0/gpx.min.js"></script>
<script src="{{ site.baseurl }}/assets/js/my_js.js"></script>


<!-- javascript for map -->
<script>
document.getElementById("showMapBtn").addEventListener("click", function () {
    const container = document.getElementById("visitedMapContainer");

    if (container.style.display === "none") {
        container.style.display = "block";
        this.textContent = "Hide map";
        initializeVisitedMap();
    } else {
        container.style.display = "none";
        this.textContent = "Show map";
    }
});

let visitedMapInitialised = false;

function initializeVisitedMap() {
    if (visitedMapInitialised) return;
    visitedMapInitialised = true;

    const map = L.map('visitedMap').setView([53.86, 10.68], 12);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    const geoUrl = "{{ site.baseurl }}/assets/data/all_routes.geojson";

    fetch(geoUrl)
        .then(res => res.json())
        .then(geojson => {
            const layer = L.geoJSON(geojson, {
                style: {
                    color: "blueviolet",
                    weight: 3,
                    opacity: 0.8
                }
            }).addTo(map);

            try {
                map.fitBounds(layer.getBounds());
            } catch (e) {
                console.warn("Could not fit bounds (geojson empty?).");
            }
        })
        .catch(err => console.error("Error loading geojson:", err));
}
</script>

